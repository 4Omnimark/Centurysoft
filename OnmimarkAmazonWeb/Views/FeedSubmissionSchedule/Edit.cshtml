@model OmnimarkAmazon.Models.FeedSubmissionScheduleRecWeb

<h2>@ViewBag.Title</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>


<script type="text/javascript">

    $(function () {
        MessageType_Changed();
    });
    
    function MessageType_Changed() {

        var val = $("#MessageType")[0].value;

        if (val != "") {

            $.ajax({
                url: "/FeedSubmissionSchedule/GetMessagePartial/@(Model.ID)?MessageType=" + val,
                success: function (html) {
                    $("#divMessageFields")[0].innerHTML = html;
                    $("form").removeData("validator");
                    $("form").removeData("unobtrusiveValidation");
                    $.validator.unobtrusive.parse("form");
                }
            });
        }
    }

</script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>@ViewBag.Legend</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Enabled)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Enabled)
            @Html.ValidationMessageFor(model => model.Enabled)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.Name, new { style = "width:500px;" })
            @Html.ValidationMessageFor(model => model.Name)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Notes)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.Notes, new { style = "width:500px; height:100px;" })
            @Html.ValidationMessageFor(model => model.Notes)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.AmazonAccountID)
        </div>
        <div class="editor-field">
            @Html.DropDownList("AmazonAccountID", (SelectList)ViewBag.AmazonAccounts, "-- Select --")
            @Html.ValidationMessageFor(model => model.AmazonAccountID)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.FeedType)
        </div>
        <div class="editor-field">
            @Html.DropDownList("FeedType", (SelectList)ViewBag.FeedTypes, "-- Select --")
            @Html.ValidationMessageFor(model => model.FeedType)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.MessageType)
        </div>
        <div class="editor-field">
            @Html.DropDownList("MessageType", (SelectList)ViewBag.MessageTypes, "-- Select --", new { onchange = "MessageType_Changed();" })
            @Html.ValidationMessageFor(model => model.MessageType)
        </div>

        <div id="divMessageFields" style="margin-left:20px; width:600px;">
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.NextRun)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.NextRun)
            @Html.ValidationMessageFor(model => model.NextRun)
        </div>

        <div class="editor-label">
            Run Every:
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.TimeSpanCount, new { style = "width:30px;" })
            @Html.ValidationMessageFor(model => model.TimeSpanCount)
            @Html.DropDownList("TimeSpanSpanType", (SelectList)ViewBag.SpanTypes, "-- Select --")
            @Html.ValidationMessageFor(model => model.TimeSpanSpanType)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.MustRunAll)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.MustRunAll)
            @Html.ValidationMessageFor(model => model.MustRunAll)
        </div>

        <p>
            <input type="submit" value="@ViewBag.ButtonText" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>
